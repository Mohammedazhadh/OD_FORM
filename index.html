<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>C.A.H.C.E.T – On-Duty Application</title>
<style>
  body{background:#0a0a0a;color:#eee;font-family:sans-serif;margin:0;padding:0;}
  header{background:#111;padding:20px;text-align:center;border-bottom:2px solid #222;}
  header h1{margin:0;color:#fff;font-size:24px;}
  main{max-width:600px;margin:30px auto;padding:20px;background:#111;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.7);}
  label{display:block;margin:12px 0 6px;font-weight:600;}
  input, select, textarea{width:100%;padding:10px;border-radius:8px;border:none;background:#222;color:#eee;}
  textarea{min-height:100px;resize:vertical;}
  button{margin-top:16px;padding:12px 18px;border:none;border-radius:8px;background:#00b894;color:#fff;font-weight:700;cursor:pointer;}
  button:hover{background:#00d4a6;}
  .footer{margin-top:20px;text-align:center;font-size:12px;color:#888;}
</style>
</head>
<body>
<header>
<h1>C.A.H.C.E.T – On-Duty Application Form</h1>
<p>Apply for OD (All Departments)</p>
</header>
<main>
<form id="odForm" onsubmit="submitForm(event)">
<label>Full Name</label>
<input type="text" name="name" required>
<label>Register Number</label>
<input type="text" name="reg" required>
<label>Department</label>
<select name="department" required>
<option>CSE</option>
<option>ECE</option>
<option>EEE</option>
<option>MECH</option>
<option>CIVIL</option>
<option>IT</option>
</select>
<label>Year & Section</label>
<select name="year" required>
<option>I-Y</option>
<option>II-Y</option>
<option>III-Y</option>
<option>IV-Y</option>
</select>
<label>Date of OD</label>
<input type="date" name="date" required>
<label>Event / Reason for OD</label>
<textarea name="reason" required></textarea>
<label>Number of Periods to be Missed</label>
<select name="periods" required>
<option>1 Period</option>
<option>2 Periods</option>
<option>3 Periods</option>
<option>4 Periods</option> 
<option>5 Periods</option>
<option>6 Periods</option>
<option>7 Periods</option>       
<option>Full Day</option>
</select>
<label>Faculty Name for Attendance Approval</label>
<select name="faculty" required>
<option>Anwarullah Sir — English</option>
<option>Kavitha Mam — Chemistry</option>
<option>Magesh Maha Mam — Essentials of Computing</option>
<option>Pushparaj Sir — Maths</option>
<option>Sathikbasha Sir — Tamil</option>
<option>Senthil Kumar Sir — HOD</option>
<option>Vadivel Sir — Physics</option>
</select>
<button type="submit">Submit OD Request</button>
<p id="msg" style="margin-top:10px;color:#00b894;font-weight:600;"></p>
</form>
<div class="footer">&copy; 2025 C.A.H.C.E.T – All Departments OD Form</div>
</main>
<script>
function submitForm(e){
  e.preventDefault();
  var form=document.getElementById('odForm');
  var data={};
  new FormData(form).forEach((v,k)=>data[k]=v);

  // Replace this with your Google Apps Script Web App URL
  var scriptURL='https://script.google.com/macros/s/AKfycbxmuz6i4i6pmYs8bkMWQ5JiWRXftWc0_32_xi37XFeTtnC-B8iv6YhYdg49dOpqGFjO6A/exec';

  fetch(scriptURL,{
    method:'POST',
    body:JSON.stringify(data),
    headers:{'Content-Type':'application/json'}
  })
  .then(res=>document.getElementById('msg').innerText='OD Request Submitted Successfully!')
  .catch(err=>document.getElementById('msg').innerText='Error submitting form.');
  
  form.reset();
}
</script>
</body>
</html>
